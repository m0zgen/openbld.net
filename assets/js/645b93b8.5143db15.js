"use strict";(self.webpackChunkopenbld_net=self.webpackChunkopenbld_net||[]).push([[7098],{7319:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>a});var n=t(4848),o=t(8453);const l={slug:"disable-systemd-resolved-throught-embed-settings",title:"\u2198  How to disable systemd-resolved through resolved.conf settings",description:"How to disable systemd-resolved through resolved.conf settings",authors:["sysadminkz"],tags:["linux","system","notes","openbld"]},r=void 0,i={permalink:"/blog/disable-systemd-resolved-throught-embed-settings",source:"@site/blog/articles/2024/2024-09-27-disable-systemd-resolved-throught-embed-settings.md",title:"\u2198  How to disable systemd-resolved through resolved.conf settings",description:"How to disable systemd-resolved through resolved.conf settings",date:"2024-09-27T00:00:00.000Z",tags:[{inline:!0,label:"linux",permalink:"/blog/tags/linux"},{inline:!0,label:"system",permalink:"/blog/tags/system"},{inline:!0,label:"notes",permalink:"/blog/tags/notes"},{inline:!0,label:"openbld",permalink:"/blog/tags/openbld"}],readingTime:.87,hasTruncateMarker:!1,authors:[{name:"Yevgeniy Goncharov",title:"Maintainer of OpenBLD.net",url:"https://github.com/m0zgen",imageURL:"https://github.com/m0zgen.png",key:"sysadminkz",page:null}],frontMatter:{slug:"disable-systemd-resolved-throught-embed-settings",title:"\u2198  How to disable systemd-resolved through resolved.conf settings",description:"How to disable systemd-resolved through resolved.conf settings",authors:["sysadminkz"],tags:["linux","system","notes","openbld"]},unlisted:!1,prevItem:{title:"\ud83d\ude80 OpenBLD.net - Switched to in-touch release model",permalink:"/blog/openbld-switched-to-in-touch-release-model-2024"},nextItem:{title:"\ud83d\udfe2\ufe0f\ufe0f\ufe0f\ufe0f\ufe0f\ufe0f OpenBLD.net New server from 3hcloud in Almaty",permalink:"/blog/openbld-new-server-from-3hcloud-in-almaty-2024-09-24"}},d={authorsImageUrls:[void 0]},a=[{value:"Intro",id:"intro",level:2},{value:"How to disable systemd-resolved",id:"how-to-disable-systemd-resolved",level:2}];function c(e){const s={a:"a",admonition:"admonition",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"OpenBLD.net - How to disable systemd-resolved",src:t(8191).A+"",width:"1250",height:"680"})}),"\n",(0,n.jsx)(s.h2,{id:"intro",children:"Intro"}),"\n",(0,n.jsxs)(s.p,{children:["In short, the ",(0,n.jsx)(s.code,{children:"systemd-resolved"})," service is a system service that provides network name resolution to local applications. It implements a caching DNS stub resolver and an LLMNR resolver and responder."]}),"\n",(0,n.jsxs)(s.p,{children:["See the ",(0,n.jsx)(s.a,{href:"https://www.freedesktop.org/software/systemd/man/latest/systemd-resolved.service.html#:~:text=systemd%2Dresolved%20is%20a%20system,and%20MulticastDNS%20resolver%20and%20responder.",children:"official documentation"})," for more information."]}),"\n",(0,n.jsxs)(s.p,{children:["In some cases, you may need to disable this service. For example, if you are using a custom DNS server or if you are using a VPN service that provides its own DNS servers.\nYou can disable Systemd-resolved using your own settings in the ",(0,n.jsx)(s.code,{children:"resolved.conf"})," file."]}),"\n",(0,n.jsx)(s.h2,{id:"how-to-disable-systemd-resolved",children:"How to disable systemd-resolved"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["Open ",(0,n.jsx)(s.code,{children:"/etc/systemd/resolved.conf"})," in your favorite text editor."]}),"\n",(0,n.jsxs)(s.li,{children:["Find ",(0,n.jsx)(s.code,{children:"DNSStubListener"})," setting and set it to ",(0,n.jsx)(s.code,{children:"no"}),"."]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"[Resolve]\n...\n#Cache=no-negative\nDNSStubListener=no\n...\n"})}),"\n",(0,n.jsxs)(s.admonition,{type:"tip",children:[(0,n.jsxs)(s.p,{children:["You can create additional config in the ",(0,n.jsx)(s.code,{children:"/etc/systemd/resolved.conf.d/"})," directory. For example, you can create a file ",(0,n.jsx)(s.code,{children:"/etc/systemd/resolved.conf.d/00-disable-stub.conf"})," with the following content:"]}),(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"[Resolve]\nDNSStubListener=no\n"})})]}),"\n",(0,n.jsxs)(s.p,{children:["Then you need to set ",(0,n.jsx)(s.code,{children:"/etc/resolv.conf"})," as symlink to ",(0,n.jsx)(s.code,{children:"/run/systemd/resolve/resolv.conf"}),":"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"ln -sf /run/systemd/resolve/resolv.conf /etc/resolv.conf\n"})}),"\n",(0,n.jsxs)(s.p,{children:["After that, restart the ",(0,n.jsx)(s.code,{children:"systemd-resolved"})," service:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"systemctl restart systemd-resolved\n"})})]})}function h(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},8191:(e,s,t)=>{t.d(s,{A:()=>n});const n=t.p+"assets/images/disable-systemd-resolved-throught-embed-settings-86f2a11ccb61cb5ce6a9a42d3052165f.jpeg"},8453:(e,s,t)=>{t.d(s,{R:()=>r,x:()=>i});var n=t(6540);const o={},l=n.createContext(o);function r(e){const s=n.useContext(l);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),n.createElement(l.Provider,{value:s},e.children)}}}]);